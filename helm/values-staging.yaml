global:
  # Environment (staging)
  environment: staging
  imagePullPolicy: IfNotPresent

# Application image configuration
image:
  repository: docker.io/oluwaseun1511/ip-reverser-app
  tag: "staging"
  pullPolicy: IfNotPresent

deployment:
  replicaCount: 2
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  
  container:
    port: 3001
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 200m
        memory: 256Mi
    
    livenessProbe:
      httpGet:
        path: /health
        port: 3001
        scheme: HTTP
      initialDelaySeconds: 30
      periodSeconds: 30
      timeoutSeconds: 5
      failureThreshold: 3
      successThreshold: 1

    readinessProbe:
      httpGet:
        path: /health
        port: 3001
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
      successThreshold: 1

    startupProbe:
      httpGet:
        path: /health
        port: 3001
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 30
      successThreshold: 1

env:
  NODE_ENV: staging
  PORT: 3001
  CORS_ORIGIN: "*"
  DATABASE_URL:
    secretName: ip-reverser-secrets
    secretKey: database-url

service:
  type: LoadBalancer
  port: 80
  targetPort: 3001
  annotations: {}

ingress:
  enabled: true
  className: "nginx"
  annotations: {}
  hosts:
    - host: staging.ip-reverse.cloudknight-api.com
      paths:
        - path: /
          pathType: Prefix
  tls: []

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 3
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

podSecurityContext:
  fsGroup: 1001
  runAsNonRoot: true
  runAsUser: 1001
  runAsGroup: 1001

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1001
  capabilities:
    drop:
      - ALL

configMap:
  data:
    NODE_ENV: "staging"
    PORT: "3001"
    CORS_ORIGIN: "*"

secrets:
  database-url: "cG9zdGdyZXNxbDovL3Bvc3RncmVzOnBhc3N3b3JkQGhvc3QuZG9ja2VyLmludGVybmFsOjU0MzMvaXByZXZlcnNlcg=="

postgresql:
  enabled: true
  auth:
    postgresPassword: "your-postgres-password"
    username: "postgres"
    password: "password"
    database: "ipreverser_staging"
  primary:
    persistence:
      enabled: true
      size: 8Gi
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 200m
        memory: 256Mi

serviceMonitor:
  enabled: true
  interval: 30s
  scrapeTimeout: 10s
  path: /metrics
  labels:
    app: ip-reverser-app

podDisruptionBudget:
  enabled: true
  minAvailable: 1

networkPolicy:
  enabled: false
  ingress:
    - from: []
      ports:
        - protocol: TCP
          port: 3001

labels: {}
annotations: {}
nodeSelector: {}
tolerations: []
affinity: {}
deploymentTime: "2025-08-18T14:20:23Z"
